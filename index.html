<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√öltimas Not√≠cias</title>
    <style>
        /* ============================================
           WIDGET DE NOT√çCIAS
           √öltima atualiza√ß√£o: 20/02/2026
           ============================================ */
        
        /* Reset e Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            background: transparent;
            padding: 20px;
            line-height: 1.5;
            color: #1a1a1a;
        }
        
        /* Cabe√ßalho do Widget */
        .widget-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #0078d4;
        }
        
        .widget-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 600;
            color: #1a1a1a;
        }
        
        .widget-icon {
            width: 28px;
            height: 28px;
            fill: #0078d4;
        }
        
        .widget-meta {
            font-size: 12px;
            color: #666;
        }
        
        /* Grid de Not√≠cias */
        .noticias-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        @media (max-width: 700px) {
            .noticias-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Card de Not√≠cia */
        .noticia-card {
            background: #ffffff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e5e5;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .noticia-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }
        
        /* Imagem da Not√≠cia */
        .noticia-imagem-wrapper {
            position: relative;
            width: 100%;
            height: 160px;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .noticia-imagem {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .noticia-card:hover .noticia-imagem {
            transform: scale(1.05);
        }
        
        /* Placeholder para imagens ausentes */
        .noticia-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0078d4 0%, #00bcf2 50%, #00b294 100%);
        }
        
        .noticia-placeholder svg {
            width: 56px;
            height: 56px;
            fill: rgba(255, 255, 255, 0.85);
        }
        
        /* Conte√∫do da Not√≠cia */
        .noticia-conteudo {
            padding: 16px;
        }
        
        /* Badge da Fonte */
        .noticia-fonte {
            display: inline-block;
            font-size: 10px;
            font-weight: 700;
            color: #ffffff;
            padding: 4px 10px;
            border-radius: 20px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Cores das fontes */
        .fonte-tecmundo { background: #dc3545; }
        .fonte-olhardigital { background: #007bff; }
        .fonte-tecnoblog { background: #6f42c1; }
        .fonte-canaltech { background: #28a745; }
        
        /* T√≠tulo da Not√≠cia */
        .noticia-titulo {
            font-size: 15px;
            font-weight: 600;
            color: #1a1a1a;
            line-height: 1.4;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            min-height: 42px;
        }
        
        .noticia-titulo a {
            color: inherit;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .noticia-titulo a:hover {
            color: #0078d4;
        }
        
        /* Data da Not√≠cia */
        .noticia-data {
            font-size: 12px;
            color: #888;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .noticia-data svg {
            width: 14px;
            height: 14px;
            fill: #888;
        }
        
        /* Estado de Carregamento */
        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid #e5e5e5;
            border-top-color: #0078d4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 14px;
            color: #666;
        }
        
        /* Estado de Erro */
        .erro {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            background: #fff5f5;
            border-radius: 12px;
            border: 1px solid #ffcccc;
        }
        
        .erro-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .erro-texto {
            color: #c53030;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- Cabe√ßalho -->
    <header class="widget-header">
        <h1 class="widget-title">
            <svg class="widget-icon" viewBox="0 0 24 24">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
            </svg>
            √öltimas Not√≠cias
        </h1>
        <span class="widget-meta" id="atualizacao">Carregando...</span>
    </header>
    
    <!-- Container das Not√≠cias -->
    <main class="noticias-grid" id="container">
        <div class="loading">
            <div class="loading-spinner"></div>
            <p class="loading-text">Carregando not√≠cias...</p>
        </div>
    </main>

    <script>
    (function() {
        'use strict';
        
        // ===========================================
        // CONFIGURA√á√ïES
        // ===========================================
        
        const CONFIG = {
            maxNoticias: 4,
            intervaloAtualizacao: 30 * 60 * 1000, // 30 minutos
            feeds: [
                { nome: 'TecMundo', url: 'https://rss.tecmundo.com.br/feed', classe: 'fonte-tecmundo' },
                { nome: 'Olhar Digital', url: 'https://olhardigital.com.br/feed/', classe: 'fonte-olhardigital' },
                { nome: 'Tecnoblog', url: 'https://tecnoblog.net/feed/', classe: 'fonte-tecnoblog' },
                { nome: 'Canaltech', url: 'https://canaltech.com.br/rss/', classe: 'fonte-canaltech' }
            ],
            proxies: [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest='
            ]
        };
        
        // Palavras para filtrar promo√ß√µes
        const FILTRO_PROMOCAO = [
            'oferta', 'ofertas', 'promo√ß√£o', 'promo√ß√µes', 'desconto', 'descontos',
            'cupom', 'cupons', 'gr√°tis', 'black friday', 'cyber monday',
            'amazon', 'magazine luiza', 'magalu', 'mercado livre', 'aliexpress',
            'shopee', 'compre agora', 'comprar', 'onde comprar', 'melhor pre√ßo',
            'cashback', 'frete gr√°tis', 'economize', 'barato', 'liquida√ß√£o',
            'deal', 'deals', 'sale', 'outlet', 'off', '% de desconto',
            'pre√ßo', 'r$', 'reais', 'parcela', 'sem juros', 'pix'
        ];
        
        // ===========================================
        // FUN√á√ïES UTILIT√ÅRIAS
        // ===========================================
        
        // Verifica se √© promo√ß√£o
        function ehPromocao(texto) {
            if (!texto) return false;
            const lower = texto.toLowerCase();
            return FILTRO_PROMOCAO.some(palavra => lower.includes(palavra));
        }
        
        // Formata a data
        function formatarData(dataStr) {
            try {
                const data = new Date(dataStr);
                const agora = new Date();
                const diffMin = Math.floor((agora - data) / 60000);
                
                if (diffMin < 1) return 'Agora';
                if (diffMin < 60) return 'H√° ' + diffMin + ' min';
                if (diffMin < 1440) return 'H√° ' + Math.floor(diffMin / 60) + 'h';
                return 'Agora h√° pouco';
            } catch (e) {
                return 'Agora h√° pouco';
            }
        }
        
        // Extrai imagem do item RSS
        function extrairImagem(item) {
            // 1. media:content
            var media = item.getElementsByTagName('media:content')[0];
            if (media) {
                var url = media.getAttribute('url');
                if (url && url.startsWith('http')) return url;
            }
            
            // 2. enclosure
            var enclosure = item.getElementsByTagName('enclosure')[0];
            if (enclosure) {
                var url = enclosure.getAttribute('url');
                if (url && url.startsWith('http')) return url;
            }
            
            // 3. content:encoded
            var content = item.getElementsByTagName('content:encoded')[0];
            if (content && content.textContent) {
                var match = content.textContent.match(/<img[^>]+src=["']([^"']+)["']/i);
                if (match && match[1]) return match[1];
            }
            
            // 4. description
            var desc = item.getElementsByTagName('description')[0];
            if (desc && desc.textContent) {
                var match = desc.textContent.match(/<img[^>]+src=["']([^"']+)["']/i);
                if (match && match[1]) return match[1];
            }
            
            return null;
        }
        
        // Extrai texto limpo
        function extrairTexto(item, tagName) {
            var elem = item.getElementsByTagName(tagName)[0];
            if (!elem) return '';
            var texto = elem.textContent || '';
            return texto.replace(/<[^>]*>/g, '').trim();
        }
        
        // ===========================================
        // RENDERIZA√á√ÉO
        // ===========================================
        
        // Cria o HTML do placeholder
        function criarPlaceholderHTML() {
            return '<div class="noticia-placeholder"><svg viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></div>';
        }
        
        // Cria card de not√≠cia
        function criarCard(noticia) {
            var card = document.createElement('article');
            card.className = 'noticia-card';
            
            // Wrapper da imagem
            var imgWrapper = document.createElement('div');
            imgWrapper.className = 'noticia-imagem-wrapper';
            
            if (noticia.imagem) {
                var img = document.createElement('img');
                img.className = 'noticia-imagem';
                img.alt = noticia.titulo;
                img.loading = 'lazy';
                
                // Handler de erro SEM usar atributo onerror inline
                img.onerror = function() {
                    this.style.display = 'none';
                    this.parentNode.innerHTML = criarPlaceholderHTML();
                };
                
                img.src = noticia.imagem;
                imgWrapper.appendChild(img);
            } else {
                imgWrapper.innerHTML = criarPlaceholderHTML();
            }
            
            card.appendChild(imgWrapper);
            
            // Conte√∫do
            var conteudo = document.createElement('div');
            conteudo.className = 'noticia-conteudo';
            
            // Fonte
            var fonte = document.createElement('span');
            fonte.className = 'noticia-fonte ' + noticia.fonteClasse;
            fonte.textContent = noticia.fonte;
            conteudo.appendChild(fonte);
            
            // T√≠tulo
            var titulo = document.createElement('h2');
            titulo.className = 'noticia-titulo';
            var link = document.createElement('a');
            link.href = noticia.link;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            link.textContent = noticia.titulo;
            titulo.appendChild(link);
            conteudo.appendChild(titulo);
            
            // Data
            var data = document.createElement('p');
            data.className = 'noticia-data';
            data.innerHTML = '<svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>' + noticia.data;
            conteudo.appendChild(data);
            
            card.appendChild(conteudo);
            
            return card;
        }
        
        // Renderiza as not√≠cias
        function renderizar(noticias) {
            var container = document.getElementById('container');
            container.innerHTML = '';
            
            if (noticias.length === 0) {
                container.innerHTML = '<div class="erro"><div class="erro-icon">üì∞</div><p class="erro-texto">Nenhuma not√≠cia encontrada no momento.<br>Tente novamente em alguns minutos.</p></div>';
                return;
            }
            
            noticias.slice(0, CONFIG.maxNoticias).forEach(function(noticia) {
                container.appendChild(criarCard(noticia));
            });
            
            // Atualiza timestamp
            var agora = new Date();
            var hora = agora.getHours().toString().padStart(2, '0');
            var minuto = agora.getMinutes().toString().padStart(2, '0');
            document.getElementById('atualizacao').textContent = 'Atualizado: ' + hora + ':' + minuto;
        }
        
        // ===========================================
        // CARREGAMENTO DOS FEEDS
        // ===========================================
        
        // Busca um feed com fallback de proxies
        async function buscarFeed(feed, proxyIndex) {
            if (proxyIndex >= CONFIG.proxies.length) {
                return [];
            }
            
            var proxy = CONFIG.proxies[proxyIndex];
            var url = proxy + encodeURIComponent(feed.url);
            
            try {
                var response = await fetch(url);
                if (!response.ok) throw new Error('HTTP ' + response.status);
                
                var texto = await response.text();
                var parser = new DOMParser();
                var xml = parser.parseFromString(texto, 'text/xml');
                var items = xml.getElementsByTagName('item');
                var noticias = [];
                
                for (var i = 0; i < items.length && noticias.length < 3; i++) {
                    var item = items[i];
                    var titulo = extrairTexto(item, 'title');
                    var descricao = extrairTexto(item, 'description');
                    
                    // Filtra promo√ß√µes
                    if (ehPromocao(titulo) || ehPromocao(descricao)) {
                        continue;
                    }
                    
                    var linkElem = item.getElementsByTagName('link')[0];
                    var link = linkElem ? linkElem.textContent.trim() : '';
                    
                    var pubDateElem = item.getElementsByTagName('pubDate')[0];
                    var pubDate = pubDateElem ? pubDateElem.textContent : '';
                    
                    noticias.push({
                        titulo: titulo,
                        link: link,
                        imagem: extrairImagem(item),
                        data: formatarData(pubDate),
                        fonte: feed.nome,
                        fonteClasse: feed.classe,
                        timestamp: new Date(pubDate).getTime() || 0
                    });
                }
                
                return noticias;
                
            } catch (e) {
                // Tenta pr√≥ximo proxy
                return buscarFeed(feed, proxyIndex + 1);
            }
        }
        
        // Carrega todas as not√≠cias
        async function carregarNoticias() {
            try {
                var promessas = CONFIG.feeds.map(function(feed) {
                    return buscarFeed(feed, 0);
                });
                
                var resultados = await Promise.all(promessas);
                var todasNoticias = [];
                
                resultados.forEach(function(noticias) {
                    todasNoticias = todasNoticias.concat(noticias);
                });
                
                // Ordena por timestamp (mais recentes primeiro)
                todasNoticias.sort(function(a, b) {
                    return b.timestamp - a.timestamp;
                });
                
                renderizar(todasNoticias);
                
            } catch (e) {
                console.error('Erro ao carregar not√≠cias:', e);
                document.getElementById('container').innerHTML = '<div class="erro"><div class="erro-icon">‚ö†Ô∏è</div><p class="erro-texto">Erro ao carregar not√≠cias.<br>Tente atualizar a p√°gina.</p></div>';
            }
        }
        
        // ===========================================
        // INICIALIZA√á√ÉO
        // ===========================================
        
        // Carrega ao iniciar
        carregarNoticias();
        
        // Atualiza automaticamente
        setInterval(carregarNoticias, CONFIG.intervaloAtualizacao);
        
    })();
    </script>
</body>
</html>


